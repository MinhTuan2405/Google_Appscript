<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Folder Pattern Creator</title>
<style>
body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  font-size: 13px;
  margin: 0;
  padding: 12px;
  background: #f5f5f7;
  color: #202124;
  overflow-y: auto;
}

h3 {
  font-size: 17px;
  font-weight: 600;
  margin-bottom: 12px;
}

/* --- Top bar --- */
.top-buttons {
  display: flex;
  flex-direction: column;
  gap: 8px;
  margin-bottom: 16px;
}

.top-buttons select {
  font-size: 14px;
  padding: 8px 12px;
  border-radius: 6px;
  border: 1px solid #dadce0;
  background: #fff;
  width: 100%;          
  min-width: 200px;
  transition: border-color 0.2s, box-shadow 0.2s;
}

.top-buttons select:focus {
  border-color: #1a73e8;
  box-shadow: 0 0 0 2px rgba(26,115,232,0.2);
}

.top-buttons .button-row {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.top-buttons button {
  background: #f8f9fa;
  border: 1px solid #dadce0;
  padding: 6px 12px;
  border-radius: 6px;
  font-size: 13px;
  cursor: pointer;
  transition: background 0.2s, border-color 0.2s, transform 0.1s;
}

.top-buttons button:hover {
  background: #e8f0fe;
  border-color: #1a73e8;
}

.top-buttons button:active {
  transform: scale(0.97);
  background: #d2e3fc;
}


/* --- Folder items --- */
.folder {
  position: relative;
  padding: 4px 8px;
  margin: 2px 0;
  border-radius: 6px;
  background: #ffffff;
  transition: background 0.2s;
}

.folder:hover {
  background: #e8f0fe;
}

.folder-left {
  display: flex;
  align-items: center;
  gap: 6px;
}

.folder-actions {
  margin-left: auto;
  display: flex;
  gap: 4px;
}

.folder-actions button {
  border: none;
  background: transparent;
  color: #5f6368;
  cursor: pointer;
  padding: 2px 4px;
  font-size: 12px;
  transition: color 0.2s;
}

.folder-actions button:hover {
  color: #1a73e8;
}

input {
  font-size: 13px;
  padding: 2px 4px;
  border: 1px solid #dadce0;
  border-radius: 4px;
  outline: none;
  background: transparent;
  transition: border-color 0.2s;
}

input:focus {
  border-color: #1a73e8;
}

.subfolders {
  margin-left: 20px;
  position: relative;
}

.subfolders::before {
  content: '';
  position: absolute;
  top: 0;
  left: 10px;
  width: 1px;
  height: 100%;
  background: #cfd8dc;
}

.subfolders .folder::before {
  content: '';
  position: absolute;
  top: 12px;
  left: -10px;
  width: 10px;
  height: 1px;
  background: #cfd8dc;
}

/* --- Pattern preview box --- */
#patternResult {
  white-space: pre;
  background: #ffffff;
  color: #202124;
  padding: 10px;
  margin-top: 12px;
  border-radius: 6px;
  font-family: monospace;
  font-size: 12px;
  max-height: 220px;
  overflow-y: auto;
  box-shadow: inset 0 0 4px rgba(60,64,67,0.1);
}

/* --- Result menu --- */
#resultMenu {
  margin-top: 12px;
  display: flex;
  gap: 10px;
  align-items: center;
}

#resultMenu button {
  background: #1a73e8;
  color: #fff;
  border: none;
  padding: 7px 16px;
  border-radius: 6px;
  font-size: 13px;
  font-weight: 500;
  cursor: pointer;
  transition: background 0.2s, transform 0.1s;
}

#resultMenu button:hover {
  background: #1558b0;
  transform: translateY(-1px);
}

#resultMenu button:active {
  transform: translateY(0);
  background: #0d3f7a;
}

#statusMessage {
  font-size: 13px;
  font-weight: 500;
}
#statusMessage.success {
  color: #188038; /* xanh lá */
}
#statusMessage.error {
  color: #d93025; /* đỏ */
}

/* --- Loading overlay --- */
#loadingOverlay {
  display: none;
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(255, 255, 255, 0.8);
  z-index: 1000;
  justify-content: center;
  align-items: center;
  font-size: 15px;
  color: #1a73e8;
  font-weight: 500;
}

.spinner {
  border: 4px solid #e0e0e0;
  border-top: 4px solid #1a73e8;
  border-radius: 50%;
  width: 28px;
  height: 28px;
  animation: spin 1s linear infinite;
  margin-right: 10px;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

</style>
</head>
<body>
  <div class="top-buttons">
    <select id="classSelect">
      <option value="">Loading...</option>
    </select>
    <div class="button-row">
      <button onclick="sendMails()">Send</button>
    </div>
  </div>

  <div id="rootsContainer"></div>
  <div id="patternResult"></div>

  <div id="loadingOverlay">
    <div class="spinner"></div>
    Please wait...
  </div>

  
  <script>
    const rootsContainer = document.getElementById('rootsContainer');
    const classSelect = document.getElementById('classSelect');

    function renderClassDropdown() {
      google.script.run.withSuccessHandler(function(classList) {
        classSelect.innerHTML = '<option value="">Select Class</option>';
        classList.forEach(cls => {
          const option = document.createElement('option');
          option.value = cls;
          option.textContent = cls;
          classSelect.appendChild(option);
        });
      }).getAllClasses(); 
    }

    renderClassDropdown();

  </script>
</body>
</html>
